![alt text](images/Architecture.svg "Architecture")

## Requirements

| Name | Version |
|------|---------|
| terraform | >= 0.14.2 |
| aws | >= 3.21.0 |

## Providers

| Name | Version |
|------|---------|
| aws | >= 3.21.0 |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| ami | AWS AMI. | `string` | n/a | yes |
| backup\_role | IAM Role for AWS Backup. | `string` | n/a | yes |
| domain\_name | The domain name which should be used for the full qualified hostname resolution. | `string` | n/a | yes |
| filesystem\_backup\_plan | Role for the EC2 IAM Instance Profile. | `string` | n/a | yes |
| hana\_data | Represents the default disk configuration for /hana/data filesystem based on the AWS storage configuration. See https://docs.aws.amazon.com/quickstart/latest/sap-hana/storage.html | `map(map(object({ amount = number, disk_size = number })))` | <pre>{<br>  "r3.2xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r3.4xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r3.8xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r4.16xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 600<br>    }<br>  },<br>  "r4.2xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r4.4xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r4.8xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r5.12xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 600<br>    }<br>  },<br>  "r5.16xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 600<br>    }<br>  },<br>  "r5.24xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 400<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 1200<br>    }<br>  },<br>  "r5.2xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r5.4xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r5.8xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "r5.metal": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 400<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 1200<br>    }<br>  },<br>  "u-12tb1.metal": {<br>    "gp2": {<br>      "amount": 4,<br>      "disk_size": 3600<br>    },<br>    "io1": {<br>      "amount": 4,<br>      "disk_size": 3600<br>    }<br>  },<br>  "u-18tb1.metal": {<br>    "gp2": {<br>      "amount": 6,<br>      "disk_size": 3600<br>    },<br>    "io1": {<br>      "amount": 6,<br>      "disk_size": 3600<br>    }<br>  },<br>  "u-24tb1.metal": {<br>    "gp2": {<br>      "amount": 6,<br>      "disk_size": 4800<br>    },<br>    "io1": {<br>      "amount": 6,<br>      "disk_size": 4800<br>    }<br>  },<br>  "u-6tb1.metal": {<br>    "gp2": {<br>      "amount": 4,<br>      "disk_size": 1800<br>    },<br>    "io1": {<br>      "amount": 4,<br>      "disk_size": 1800<br>    }<br>  },<br>  "u-9tb1.metal": {<br>    "gp2": {<br>      "amount": 4,<br>      "disk_size": 2700<br>    },<br>    "io1": {<br>      "amount": 4,<br>      "disk_size": 2700<br>    }<br>  },<br>  "x1.16xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 400<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 1200<br>    }<br>  },<br>  "x1.32xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 800<br>    },<br>    "io1": {<br>      "amount": 3,<br>      "disk_size": 800<br>    }<br>  },<br>  "x1e.2xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  },<br>  "x1e.32xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 1600<br>    },<br>    "io1": {<br>      "amount": 3,<br>      "disk_size": 1600<br>    }<br>  },<br>  "x1e.4xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 600<br>    }<br>  },<br>  "x1e.xlarge": {<br>    "gp2": {<br>      "amount": 3,<br>      "disk_size": 225<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 300<br>    }<br>  }<br>}</pre> | no |
| hana\_data\_amount | Amount of stripes for the /hana/data filesystem. | `number` | `null` | no |
| hana\_data\_device\_names | Fixed device list for /hana/data volume which is currently up to 6 devices | `list(string)` | <pre>[<br>  "/dev/sdi",<br>  "/dev/sdj",<br>  "/dev/sdk",<br>  "/dev/sdl",<br>  "/dev/sdm",<br>  "/dev/sdn"<br>]</pre> | no |
| hana\_data\_size | Size of the /hana/data filesystem. | `number` | `null` | no |
| hana\_data\_type | Type of the /hana/data filesystem. Either gp2 or io1 currently. | `string` | `"gp2"` | no |
| hana\_log | Represents the default disk configuration for /hana/log filesystem based on the gp2 storage type. See https://docs.aws.amazon.com/quickstart/latest/sap-hana/storage.html | `map(map(object({ amount = number, disk_size = number })))` | <pre>{<br>  "r3.2xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r3.4xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r3.8xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r4.16xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r4.2xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r4.4xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r4.8xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r5.12xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r5.16xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r5.24xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "r5.2xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r5.4xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r5.8xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "r5.metal": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "u-12tb1.metal": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "u-18tb1.metal": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "u-24tb1.metal": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "u-6tb1.metal": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "u-9tb1.metal": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "x1.16xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "x1.32xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "x1e.2xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "x1e.32xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 300<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 525<br>    }<br>  },<br>  "x1e.4xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  },<br>  "x1e.xlarge": {<br>    "gp2": {<br>      "amount": 2,<br>      "disk_size": 175<br>    },<br>    "io1": {<br>      "amount": 1,<br>      "disk_size": 260<br>    }<br>  }<br>}</pre> | no |
| hana\_log\_amount | Amount of stripes for the /hana/log filesystem. | `number` | `null` | no |
| hana\_log\_device\_names | Fixed device list for /hana/log volume which is currently up to 2 devices | `list(string)` | <pre>[<br>  "/dev/sdo",<br>  "/dev/sdp"<br>]</pre> | no |
| hana\_log\_size | Size of the /hana/data filesystem. | `number` | `null` | no |
| hana\_log\_type | Type of the /hana/log filesystem. Either gp2 or io1 currently. | `string` | `"gp2"` | no |
| hana\_shared | Represents the default disk configuration for /hana/shared filesystem based on the AWS storage configuration. See https://docs.aws.amazon.com/quickstart/latest/sap-hana/storage.html | `map` | <pre>{<br>  "r3.2xlarge": 300,<br>  "r3.4xlarge": 300,<br>  "r3.8xlarge": 300,<br>  "r4.16xlarge": 512,<br>  "r4.2xlarge": 300,<br>  "r4.4xlarge": 300,<br>  "r4.8xlarge": 300,<br>  "r5.12xlarge": 512,<br>  "r5.16xlarge": 512,<br>  "r5.24xlarge": 1024,<br>  "r5.2xlarge": 300,<br>  "r5.4xlarge": 300,<br>  "r5.8xlarge": 300,<br>  "r5.metal": 1024,<br>  "u-12tb1.metal": 1024,<br>  "u-18tb1.metal": 1024,<br>  "u-24tb1.metal": 1024,<br>  "u-6tb1.metal": 1024,<br>  "u-9tb1.metal": 1024,<br>  "x1.32xlarge": 1024,<br>  "x1e.2xlarge": 300,<br>  "x1e.32xlarge": 1024,<br>  "x1e.4xlarge": 512,<br>  "x1e.xlarge": 300<br>}</pre> | no |
| hana\_shared\_size | Size of the /hana/data filesystem. | `number` | `null` | no |
| hostname | Hostname of the provided instance. | `string` | n/a | yes |
| instance\_role | Role for the EC2 IAM Instance Profile. | `string` | `null` | no |
| instance\_type | AWS Instance Type. | `string` | n/a | yes |
| kms\_key\_id | KMS Key for encryption. | `string` | `null` | no |
| sap\_instance\_number | Instance Number of the App Server. | `number` | n/a | yes |
| sap\_sid | SAP System identifier. | `string` | n/a | yes |
| ssh\_public\_key | SSH Key for the EC2-Instance. | `string` | n/a | yes |
| subnet\_id | Subnet ID to deploy the EC2 Instance. | `string` | n/a | yes |
| swap\_size | Size of the swap filesystem. | `number` | `32` | no |
| usrsap\_size | Size of the /usr/sap filesystem. | `number` | `15` | no |

## Outputs

No output.
